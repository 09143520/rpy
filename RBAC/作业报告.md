# 查询用户test1可以查看的页面
SELECT CF_Privilege.PrivilegeMaster AS 角色类型,</br>
CF_Privilege.PrivilegeMasterKey AS 类型编号, CF_Privilege.PrivilegeAccess AS 对象类型, CF_Privilege.PrivilegeAccessKey AS 对象编号, Sys_Menu.MenuName AS 菜单名称
FROM ((CF_Role INNER JOIN (CF_UserRole INNER JOIN CF_User ON CF_UserRole.UserID = CF_User.UserID) ON CF_Role.RoleID = CF_UserRole.RoleID) INNER JOIN CF_Privilege ON CF_Role.RoleID = CF_Privilege.PrivilegeMasterKey) INNER JOIN Sys_Menu ON CF_Privilege.PrivilegeAccessKey = Sys_Menu.MenuID
WHERE (((CF_User.LoginName)='test1') AND ((CF_Privilege.PrivilegeOperation)='Permit'));

# 查询结果
![页面](https://github.com/09143520/rpy/blob/master/RBAC/menu.JPG)

# 伪代码
1、根据名称查找人员编号UserID
2、根据人员编号UserID查找改人员所对应的角色集合RoleID
3、权限表 LEFT JOIN 页面表并查找
   角色类型为CF_Role   AND   角色编号在角色集合RoleID中
  OR
   角色类型为CF_User   AND   人员编号为UserID
  AND 权限属性为Permit   AND   权限为Sys_Menu的数据

# 提前预警查询语句
##
SELECT 设备保养单.设备类型, 设备保养单.设备号, 设备保养单.保养类别, 设备保养单.日期
FROM (保养类别 INNER JOIN 设备保养单 ON (保养类别.保养类别 = 设备保养单.保养类别) AND (保养类别.保养类别 = 设备保养单.保养类别)) INNER JOIN 设备 ON (保养类别.保养类别 = 设备.保养类别) AND (设备保养单.设备号 = 设备.设备号)
WHERE (((Date()-[日期]+[提前预警期])=[周期]));

![检修报告图](https://github.com/09143520/guanlixx/blob/master/图片/检修报告查询.png)

